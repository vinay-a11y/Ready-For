  /* ---------------- LOGIN ---------------- */
  loginForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    hideMessages();

    try {
      const formData = new FormData(loginForm);

      const response = await fetch("/login", {
        method: "POST",
        body: formData,
        credentials: "include", // â­ REQUIRED FOR COOKIES
      });

      const result = await response.json();

      if (!response.ok) {
        throw new Error(result.detail || "Invalid credentials");
      }

      // Save safe user info (NOT TOKEN)
      localStorage.setItem("user", JSON.stringify(result.user));

      successText.textContent = result.message || "Login successful!";
      successMessage.style.display = "block";

      setTimeout(() => {
       
          window.location.href = "/";
        
      }, 800);

    } catch (err) {
      errorText.textContent = err.message || "Login failed";
      errorMessage.style.display = "block";
    }
  });